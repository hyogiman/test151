<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê´€ë¦¬ì í˜ì´ì§€ - ì—”ì§€ë‹ˆì–´ êµìœ¡ ê²Œì„</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 12px;
            padding: 30px 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            max-width: 900px;
            margin: 0 auto;
        }

        .title {
            font-size: 2rem;
            color: #2c3e50;
            margin-bottom: 20px;
            font-weight: 600;
            text-align: center;
        }

        .subtitle {
            font-size: 1rem;
            color: #7f8c8d;
            margin-bottom: 15px;
            text-align: center;
            line-height: 1.4;
        }

        .message-display {
            font-size: 1.4rem;
            font-weight: 500;
            color: #2c3e50;
            margin: 20px 0;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            line-height: 1.5;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }

        .button {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 1rem;
            border-radius: 6px;
            cursor: pointer;
            margin: 8px;
            transition: all 0.2s ease;
            font-weight: 500;
        }

        .button:hover {
            background: #2980b9;
            transform: translateY(-1px);
        }

        .button:active {
            transform: translateY(0);
        }

        .reset-button {
            background: #e74c3c;
        }

        .reset-button:hover {
            background: #c0392b;
        }

        .message-list {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #e9ecef;
        }

        .message-item {
            background: white;
            padding: 12px;
            margin: 8px 0;
            border-radius: 6px;
            border-left: 4px solid #3498db;
            text-align: left;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .message-item.active {
            background: #e3f2fd;
            border-left-color: #2196f3;
        }

        .admin-controls {
            display: flex;
            flex-direction: column;
            gap: 20px;
            align-items: center;
            width: 100%;
        }

        .button-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .status-info {
            background: #e8f5e8;
            border: 1px solid #4caf50;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .status-info h3 {
            color: #2e7d32;
            margin: 0 0 15px 0;
            font-size: 1.2rem;
        }

        .status-info p {
            color: #388e3c;
            margin: 8px 0;
            font-size: 0.9rem;
        }

        .participants-list {
            margin-top: 15px;
            text-align: left;
            max-height: 200px;
            overflow-y: auto;
        }

        .participants-list h4 {
            color: #2e7d32;
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .team-group {
            margin: 8px 0;
            padding: 8px;
            background: #f0f8f0;
            border-radius: 4px;
            font-size: 0.85rem;
        }

        .team-group strong {
            color: #2e7d32;
        }

        /* ëª¨ë°”ì¼ ëŒ€ì‘ */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 20px 15px;
            }
            
            .title {
                font-size: 1.6rem;
            }
            
            .message-display {
                font-size: 1.2rem;
                min-height: 60px;
                padding: 15px;
            }
            
            .button {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
            
            .button-group {
                flex-direction: column;
                align-items: center;
            }
            
            .message-list {
                max-height: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="title">ê´€ë¦¬ì í˜ì´ì§€</h1>
        
        <div class="status-info">
            <h3>ğŸ“Š í˜„ì¬ ìƒíƒœ</h3>
            <p>ì°¸ê°€ì í™”ë©´: <a href="index.html" target="_blank">index.html</a></p>
            <p>ì°¸ê°€ìë“¤ì´ ìœ„ ë§í¬ë¡œ ì ‘ì†í•˜ì—¬ íŒ€ëª…ê³¼ ì‚¬ë²ˆì„ ì…ë ¥í•œ í›„ ì œì‹œë¬¸ì„ í™•ì¸í•©ë‹ˆë‹¤.</p>
            <p>í˜„ì¬ í™œì„± ì°¸ê°€ì ìˆ˜: <span id="active-participants-count">í™•ì¸ ì¤‘...</span></p>
            <div id="participants-list" class="participants-list"></div>
        </div>
        
        <div class="admin-controls">
            <div class="message-list">
                <h3>ğŸ“‹ ì œì‹œë¬¸ ëª©ë¡ (ì´ 15ê°œ)</h3>
                <div id="message-list"></div>
            </div>

            <div class="button-group">
                <button class="button" onclick="showRandomMessage()">
                    ğŸ² ëœë¤ ë©”ì‹œì§€ í‘œì‹œ
                </button>
                <button class="button reset-button" onclick="resetMessage()">
                    ğŸ”„ í™”ë©´ ë¦¬ì…‹
                </button>
            </div>

            <div id="current-message-display" style="display: none;">
                <h3>ğŸ“º í˜„ì¬ í‘œì‹œ ì¤‘ì¸ ë©”ì‹œì§€:</h3>
                <div class="message-display" id="admin-current-message"></div>
            </div>
        </div>
    </div>

    <script>
        const messages = [
            "íš¨ìœ¨ì ì¸ ì½”ë“œ ë¦¬ë·° í”„ë¡œì„¸ìŠ¤ë¥¼ ì„¤ê³„í•´ë³´ì„¸ìš”",
            "ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜ì˜ ì¥ë‹¨ì ì„ ë¶„ì„í•´ë³´ì„¸ìš”",
            "ë°ì´í„°ë² ì´ìŠ¤ ì„±ëŠ¥ ìµœì í™” ì „ëµì„ ì œì‹œí•´ë³´ì„¸ìš”",
            "ë³´ì•ˆ ì·¨ì•½ì ì„ ì°¾ì•„ë‚´ëŠ” ë°©ë²•ì„ ì„¤ëª…í•´ë³´ì„¸ìš”",
            "ì‚¬ìš©ì ê²½í—˜ì„ ê°œì„ í•˜ëŠ” UI/UX ì„¤ê³„ ì›ì¹™ì„ ì„¤ëª…í•´ë³´ì„¸ìš”",
            "í´ë¼ìš°ë“œ ë„¤ì´í‹°ë¸Œ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œ ë°©ë²•ë¡ ì„ ì„¤ëª…í•´ë³´ì„¸ìš”",
            "DevOps íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•˜ëŠ” ë‹¨ê³„ë³„ ë°©ë²•ì„ ì œì‹œí•´ë³´ì„¸ìš”",
            "ëŒ€ìš©ëŸ‰ ë°ì´í„° ì²˜ë¦¬ ì‹œìŠ¤í…œì„ ì„¤ê³„í•´ë³´ì„¸ìš”",
            "ëª¨ë°”ì¼ ì•± ì„±ëŠ¥ ìµœì í™” ê¸°ë²•ì„ ì„¤ëª…í•´ë³´ì„¸ìš”",
            "API ì„¤ê³„ì˜ ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤ë¥¼ ì œì‹œí•´ë³´ì„¸ìš”",
            "í…ŒìŠ¤íŠ¸ ìë™í™” ì „ëµì„ ìˆ˜ë¦½í•´ë³´ì„¸ìš”",
            "ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹… ì‹œìŠ¤í…œì„ ì„¤ê³„í•´ë³´ì„¸ìš”",
            "ìŠ¤ì¼€ì¼ëŸ¬ë¸”í•œ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì•„í‚¤í…ì²˜ë¥¼ ì œì•ˆí•´ë³´ì„¸ìš”",
            "ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ ì „ëµì„ ìˆ˜ë¦½í•´ë³´ì„¸ìš”",
            "ì‹¤ì‹œê°„ ë°ì´í„° ì²˜ë¦¬ ì‹œìŠ¤í…œì„ ì„¤ê³„í•´ë³´ì„¸ìš”"
        ];

        let currentMessage = '';

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.onload = function() {
            // ë©”ì‹œì§€ ëª©ë¡ ìƒì„±
            createMessageList();
            
            // ì‹¤ì‹œê°„ ë¦¬ìŠ¤ë„ˆ ì‹œì‘
            startRealtimeListener();
        };

        // ì‹¤ì‹œê°„ ë¦¬ìŠ¤ë„ˆ ì‹œì‘
        function startRealtimeListener() {
            // ì´ˆê¸° ìƒíƒœ ì—…ë°ì´íŠ¸
            updateActiveParticipantsCount();
            
            // ì‹¤ì‹œê°„ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            window.addEventListener('storage', function(e) {
                if (e.key === 'activeParticipants') {
                    updateActiveParticipantsCount();
                } else if (e.key === 'assignedMessages' || e.key === 'messageTimestamp') {
                    checkCurrentMessage();
                }
            });
            
            // ì£¼ê¸°ì  í™•ì¸ (ë°±ì—…ìš©, 2ì´ˆë§ˆë‹¤)
            setInterval(updateActiveParticipantsCount, 2000);
        }

        // ë©”ì‹œì§€ ëª©ë¡ ìƒì„±
        function createMessageList() {
            const messageList = document.getElementById('message-list');
            messageList.innerHTML = '';
            
            messages.forEach((message, index) => {
                const div = document.createElement('div');
                div.className = 'message-item';
                div.innerHTML = `<strong>${index + 1}.</strong> ${message}`;
                messageList.appendChild(div);
            });
        }

        // ëœë¤ ë©”ì‹œì§€ í‘œì‹œ (íŒ€ë³„ë¡œ ë‹¤ë¥¸ ë©”ì‹œì§€, ê°™ì€ íŒ€ ë‚´ì—ì„œëŠ” ì„œë¡œ ë‹¤ë¥¸ ë©”ì‹œì§€)
        function showRandomMessage() {
            // í˜„ì¬ í™œì„±í™”ëœ ëª¨ë“  ì°¸ê°€ì ê°€ì ¸ì˜¤ê¸°
            const activeParticipants = getActiveParticipants();
            
            if (activeParticipants.length === 0) {
                alert('âš ï¸ í˜„ì¬ í™œì„± ì°¸ê°€ìê°€ ì—†ìŠµë‹ˆë‹¤. ì°¸ê°€ìë“¤ì´ í˜ì´ì§€ë¥¼ ì—´ì–´ì£¼ì„¸ìš”.');
                return;
            }
            
            // íŒ€ë³„ë¡œ ê·¸ë£¹í™”
            const teamGroups = {};
            activeParticipants.forEach(participant => {
                if (!teamGroups[participant.team]) {
                    teamGroups[participant.team] = [];
                }
                teamGroups[participant.team].push(participant);
            });
            
            // ê° íŒ€ë³„ë¡œ ë©”ì‹œì§€ í• ë‹¹
            const assignedMessages = {};
            
            Object.keys(teamGroups).forEach(teamName => {
                const teamMembers = teamGroups[teamName];
                const usedMessages = new Set();
                
                teamMembers.forEach(participant => {
                    let randomIndex;
                    let attempts = 0;
                    
                    // ê°™ì€ íŒ€ ë‚´ì—ì„œ ì¤‘ë³µë˜ì§€ ì•ŠëŠ” ë©”ì‹œì§€ ì°¾ê¸°
                    do {
                        randomIndex = Math.floor(Math.random() * messages.length);
                        attempts++;
                    } while (usedMessages.has(randomIndex) && attempts < 50);
                    
                    usedMessages.add(randomIndex);
                    assignedMessages[participant.id] = messages[randomIndex];
                });
            });
            
            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— í• ë‹¹ëœ ë©”ì‹œì§€ ì €ì¥
            localStorage.setItem('assignedMessages', JSON.stringify(assignedMessages));
            localStorage.setItem('messageTimestamp', Date.now().toString());
            
            // í˜„ì¬ ë©”ì‹œì§€ ì—…ë°ì´íŠ¸ (ê´€ë¦¬ì í™”ë©´ìš©)
            currentMessage = 'íŒ€ë³„ë¡œ ë‹¤ë¥¸ ë©”ì‹œì§€ê°€ í• ë‹¹ë˜ì—ˆìŠµë‹ˆë‹¤.';
            
            updateAdminDisplay();
            updateMessageList();
            
            // ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
            const teamCount = Object.keys(teamGroups).length;
            alert(`âœ… ${activeParticipants.length}ëª…ì˜ ì°¸ê°€ì (${teamCount}ê°œ íŒ€)ì—ê²Œ ë©”ì‹œì§€ê°€ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nê°™ì€ íŒ€ ë‚´ì—ì„œëŠ” ì„œë¡œ ë‹¤ë¥¸ ë©”ì‹œì§€ê°€, ë‹¤ë¥¸ íŒ€ë¼ë¦¬ëŠ” ê°™ì€ ë©”ì‹œì§€ê°€ í• ë‹¹ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`);
        }

        // ë©”ì‹œì§€ ë¦¬ì…‹
        function resetMessage() {
            currentMessage = '';
            localStorage.removeItem('assignedMessages');
            localStorage.removeItem('messageTimestamp');
            updateAdminDisplay();
            updateMessageList();
            
            // ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
            alert('ğŸ”„ ëª¨ë“  ì°¸ê°€ì í™”ë©´ì´ ë¦¬ì…‹ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        // í™œì„± ì°¸ê°€ì ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
        function getActiveParticipants() {
            try {
                const activeParticipants = JSON.parse(localStorage.getItem('activeParticipants') || '[]');
                // 5ë¶„ ì´ë‚´ì— ì ‘ì†í•œ ì°¸ê°€ìë§Œ í™œì„±ìœ¼ë¡œ ê°„ì£¼
                const now = Date.now();
                const active = activeParticipants.filter(p => (now - p.timestamp) < 300000); // 5ë¶„
                return active;
            } catch (error) {
                console.error('í™œì„± ì°¸ê°€ì ëª©ë¡ ê°€ì ¸ì˜¤ê¸° ì˜¤ë¥˜:', error);
                return [];
            }
        }

        // ê´€ë¦¬ì í™”ë©´ ì—…ë°ì´íŠ¸
        function updateAdminDisplay() {
            const adminCurrentMessage = document.getElementById('admin-current-message');
            const currentMessageDisplay = document.getElementById('current-message-display');
            
            if (currentMessage) {
                adminCurrentMessage.textContent = currentMessage;
                currentMessageDisplay.style.display = 'block';
            } else {
                currentMessageDisplay.style.display = 'none';
            }
        }

        // ë©”ì‹œì§€ ëª©ë¡ ì—…ë°ì´íŠ¸ (í™œì„± ë©”ì‹œì§€ í•˜ì´ë¼ì´íŠ¸)
        function updateMessageList() {
            const messageItems = document.querySelectorAll('.message-item');
            messageItems.forEach((item, index) => {
                if (messages[index] === currentMessage) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
        }

        // í™œì„± ì°¸ê°€ì ìˆ˜ ì—…ë°ì´íŠ¸
        function updateActiveParticipantsCount() {
            const activeParticipants = getActiveParticipants();
            const countElement = document.getElementById('active-participants-count');
            const participantsListElement = document.getElementById('participants-list');
            
            countElement.textContent = activeParticipants.length + 'ëª…';
            
            // ì°¸ê°€ì ëª©ë¡ í‘œì‹œ
            if (activeParticipants.length > 0) {
                const teamGroups = {};
                activeParticipants.forEach(participant => {
                    if (!teamGroups[participant.team]) {
                        teamGroups[participant.team] = [];
                    }
                    teamGroups[participant.team].push(participant);
                });
                
                let listHTML = '<h4>ğŸ“‹ ì°¸ê°€ì ëª©ë¡:</h4>';
                Object.keys(teamGroups).forEach(teamName => {
                    listHTML += `<div class="team-group"><strong>${teamName}</strong>: `;
                    const members = teamGroups[teamName].map(p => p.employee).join(', ');
                    listHTML += `${members} (${teamGroups[teamName].length}ëª…)</div>`;
                });
                
                participantsListElement.innerHTML = listHTML;
            } else {
                participantsListElement.innerHTML = '<p style="color: #666;">í˜„ì¬ í™œì„± ì°¸ê°€ìê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
            }
        }

        // í˜„ì¬ ë©”ì‹œì§€ í™•ì¸
        function checkCurrentMessage() {
            const assignedMessages = localStorage.getItem('assignedMessages');
            const messageTimestamp = localStorage.getItem('messageTimestamp');
            
            if (assignedMessages && messageTimestamp) {
                currentMessage = 'íŒ€ë³„ë¡œ ë‹¤ë¥¸ ë©”ì‹œì§€ê°€ í• ë‹¹ë˜ì—ˆìŠµë‹ˆë‹¤.';
            } else {
                currentMessage = '';
            }
            
            updateAdminDisplay();
            updateMessageList();
        }
    </script>
</body>
</html> 